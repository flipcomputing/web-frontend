- Open pgAdmin on localhost:5050
- Run the following SQL query to get the database to the position it was in at the end of the Databases Unit

```SQL
CREATE TABLE "sequel-mart-schema"."Product_Offers"(
offer_id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
offer_name VARCHAR(50),
product_id INT DEFAULT 0,
offer_discount_percentage NUMERIC(4,2),
offer_start_date DATE,
offer_end_date DATE
);

INSERT INTO  "sequel-mart-schema"."Product_Offers" (offer_name, product_id, offer_discount_percentage, offer_start_date, offer_end_date)
VALUES
('Gooseberry Seasonal Saver', 46, 5.25, '2021-03-05', '2021-04-02'),
('Damson Delighter', 34, 11.95, '2021-03-12', '2021-03-26'),
('Not Mushroom for a Discount', 107, 0.82, '2021-04-06', '2021-05-13'),
('Parsnipped Price', 112, 8.50, '2021-05-03', '2021-06-30'),
('Little Gem of a Discount', 105, 12.92, '2021-05-25', '2021-06-25'),
('Offer from the Savoy', 76, 7.35, '2021-05-04', '2021-07-01'),
('Peppered with Green Promise', 86, 14.25, '2021-06-14', '2021-07-21'),
('Cannot Beat this Rooted Deal', 68, 18.56, '2021-06-19', '2021-07-06'),
('An offer to be Gladioli about', 5, 9.95, '2021-06-29', '2021-07-15'),
('A Plum deal', 51, 7.45, '2021-07-05', '2021-07-29'),
('Forced Rhubarb and custard', 114, 4.85, '2021-07-18', '2021-07-26'),
('A Runner for your money', 117, 2.38, '2021-07-26', '2021-08-13'),
('A Vine deal on Tomatoes', 127, 11.25, '2021-08-09', '2021-08-24'),
('Turnip early', 128, 6.50, '2021-01-15', '2021-02-15'),
('Watercress down', 129, 1.99, '2021-08-25', '2021-09-14'),
('Sweeeeeede', 122, 4.44, '2021-08-28', '2021-09-09'),
('Better than currant price', 33, 0.95, '2021-08-31', '2021-09-12'),
('Tip of the Iceberg', 104, 1.25, '2021-09-02', '2021-09-21'),
('Discovery of a deal', 37, 6.84, '2021-09-04', '2021-09-25');

CREATE VIEW "sequel-mart-schema".v_Product_Offers_And_Products
AS
SELECT po.offer_id, po.offer_name, po.offer_discount_percentage, po.offer_start_date, po.offer_end_date, pr.product_id, pr.product_category, pr.product_item, pr.product_variety, pr.popularity
FROM "sequel-mart-schema"."Product_Offers" AS po
INNER JOIN "sequel-mart-schema"."Products" AS pr
	ON pr.product_id = po.product_id;

CREATE VIEW "sequel-mart-schema".v_Top_Transactions
AS
SELECT sh.sale_id AS Transaction
	, cu.customer_name AS Customer
	, sh.date_sale AS Date
	, sh.feedback_score AS Feedback
	, SUM(sd.revenue) AS Amount
	, SUM(sd.items_sold) AS Items
FROM "sequel-mart-schema"."Sales_Header" AS sh
INNER JOIN "sequel-mart-schema"."Customers" AS cu ON cu.customer_id = sh.customer_id
INNER JOIN "sequel-mart-schema"."Sales_Detail" AS sd ON sh.sale_id = sd.sale_id
GROUP BY sh.sale_id
	, cu.customer_name
	, sh.date_sale
	, sh.feedback_score
ORDER BY date_sale DESC
LIMIT 10;

CREATE VIEW "sequel-mart-schema".v_Top_Customers
AS
SELECT cu.customer_name AS customer
	, MIN(sh.date_sale) AS most_recent
	, COUNT(sh.sale_id) AS transactions
	, ROUND(AVG(sd.revenue),2) AS avg_spend
	, ROUND(AVG(items_sold),2) AS avg_items
	, ROUND(AVG(sh.feedback_score),1) AS avg_feedback
FROM "sequel-mart-schema"."Customers" AS cu
INNER JOIN "sequel-mart-schema"."Sales_Header" AS sh ON cu.customer_id = sh.customer_id
INNER JOIN "sequel-mart-schema"."Sales_Detail" AS sd ON sh.sale_id = sd.sale_id
GROUP BY cu.customer_name
ORDER BY AVG(sd.revenue) DESC
LIMIT 10;

CREATE VIEW "sequel-mart-schema".v_Top_Products
AS
SELECT pr.product_item
	, pr.product_variety
	, pr.pack_size
	, pr.unit_sales_price AS unit_price
	, pr.inventory
	, SUM(sd.items_sold) AS items_sold
FROM "sequel-mart-schema"."Products" AS pr
INNER JOIN "sequel-mart-schema"."Sales_Detail" AS sd ON pr.product_id = sd.product_id
GROUP BY pr.product_item
	, pr.product_variety
	, pr.pack_size
	, pr.unit_sales_price
	, pr.inventory
ORDER BY SUM(sd.items_sold) DESC
LIMIT 10;

CREATE VIEW "sequel-mart-schema".v_Summary
AS
SELECT COUNT(DISTINCT sh.sale_id) AS total_transactions
	, SUM(sd.items_sold) AS total_products_sold
	, ROUND(AVG(sh.feedback_score),1) AS avg_feedback
	, SUM(sd.revenue_net) AS revenue
	, SUM(sd.cost_of_sales) AS cost_of_sales
	, SUM(sd.revenue_net) - SUM(sd.cost_of_sales) AS gross_profit
FROM "sequel-mart-schema"."Sales_Header" AS sh
INNER JOIN "sequel-mart-schema"."Sales_Detail" AS sd ON sh.sale_id = sd.sale_id;
;

CREATE VIEW "sequel-mart-schema".v_Product_Details
AS
SELECT 
    product_id, 
    product_item || ' - ' || product_variety AS product_item
FROM 
    "sequel-mart-schema"."Products";

```
